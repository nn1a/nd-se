<!DOCTYPE html>
<html>
<head>
    <title>MDX Render Test</title>
    <style>
        pre {
            background: #1a1a1a;
            color: #fff;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        code {
            font-family: 'Courier New', monospace;
        }
        .tabs-container {
            border: 1px solid #ddd;
            border-radius: 8px;
            margin: 1rem 0;
        }
        .tab-nav {
            display: flex;
            border-bottom: 1px solid #ddd;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border: none;
            background: none;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        .tab-button.active {
            border-bottom-color: #007acc;
            color: #007acc;
        }
        .tab-content {
            padding: 1rem;
        }
        .tab-panel {
            display: none;
        }
        .tab-panel.active {
            display: block;
        }
    </style>
</head>
<body>
    <h1>MDX Render Test</h1>
    
    <div id="content"></div>
    
    <script>
        // Simulate the parsing process
        const htmlContent = `
        <h2>API Integration Example</h2>
        
        <Tabs defaultTab={0}>
          <Tab label="Fetch Documents (typescript)">
            import { useState, useEffect } from 'react'
            
            interface Document {
              id: string
              title: string
              slug: string
              content: string
            }
            
            const useFetchDocs = () => {
              const [docs, setDocs] = useState<Document[]>([])
              
              useEffect(() => {
                fetch('/api/docs')
                  .then(res => res.json())
                  .then(setDocs)
              }, [])
              
              return docs
            }
          </Tab>
          <Tab label="Python Example">
            import requests
            
            def fetch_documents():
                response = requests.get('http://localhost:8000/docs/')
                return response.json()
                
            docs = fetch_documents()
            print(f"Found {len(docs)} documents")
          </Tab>
        </Tabs>
        `
        
        function parseMDXComponents(content) {
            let processed = content
            
            // Handle Tabs
            processed = processed.replace(/<Tabs(?:\s+defaultTab=\{(\d+)\})?>([\s\S]*?)<\/Tabs>/g, 
                (match, defaultTab, tabsContent) => {
                    let tabIndex = 0
                    let tabButtons = ''
                    let tabPanels = ''
                    
                    tabsContent.replace(/<Tab\s+label="([^"]*)">([\s\S]*?)<\/Tab>/g, 
                        (tabMatch, label, content) => {
                            const isActive = parseInt(defaultTab || '0') === tabIndex
                            
                            tabButtons += `<button class="tab-button ${isActive ? 'active' : ''}" data-tab="${tabIndex}">${label}</button>`
                            
                            // Convert code content to proper pre/code
                            let cleanContent = content.trim()
                            if (!cleanContent.includes('<pre>')) {
                                cleanContent = `<pre><code>${cleanContent.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')}</code></pre>`
                            }
                            
                            tabPanels += `<div class="tab-panel ${isActive ? 'active' : ''}" data-tab="${tabIndex}">${cleanContent}</div>`
                            
                            tabIndex++
                            return ''
                        }
                    )
                    
                    return `<div class="tabs-container">
                        <div class="tab-nav">${tabButtons}</div>
                        <div class="tab-content">${tabPanels}</div>
                    </div>`
                }
            )
            
            return processed
        }
        
        function addTabEventListeners() {
            const tabButtons = document.querySelectorAll('.tab-button')
            const tabPanels = document.querySelectorAll('.tab-panel')
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabIndex = button.getAttribute('data-tab')
                    
                    // Update buttons
                    tabButtons.forEach(btn => btn.classList.remove('active'))
                    button.classList.add('active')
                    
                    // Update panels
                    tabPanels.forEach(panel => panel.classList.remove('active'))
                    const targetPanel = document.querySelector(`[data-tab="${tabIndex}"].tab-panel`)
                    if (targetPanel) targetPanel.classList.add('active')
                })
            })
        }
        
        // Render
        const processed = parseMDXComponents(htmlContent)
        document.getElementById('content').innerHTML = processed
        addTabEventListeners()
    </script>
</body>
</html>
